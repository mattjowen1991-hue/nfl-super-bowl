<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>üèà Super Bowl LIX ‚Äî League Table</title>
  <link rel="icon" type="image/png" sizes="48x48" href="Assets/nfl-favicon2.png" />

  <!-- Tailwind CSS via CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Preload background for faster paint -->
  <link rel="preload" as="image" href="Assets/football-field.jpeg" />

  <style>
    /* ---------------- Fonts & base ---------------- */
    @font-face {
      font-family: 'Freshman';
      src: url('Assets/Freshman.ttf') format('truetype');
      font-weight: normal;
      font-style: normal;
      font-display: swap;
    }
    html, body { height: 100%; background-color: #000; }
    body.no-scroll { overflow: hidden; }

    /* Page background (covers full scroll) */
    body{
      min-height:100%;
      background:
        linear-gradient(to bottom, rgba(0,0,0,.72), rgba(0,0,0,.62), rgba(0,0,0,.86)),
        url('Assets/football-field.jpeg') center center / cover fixed no-repeat;
    }

    /* Helpers */
    .modal-hidden { display: none; }
    .modal-shown { display: block; }
    .rule-key { color: #ef4444; font-weight: 800; }
    .card-hover { transition: transform .15s ease, box-shadow .15s ease; }
    .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 24px rgba(0,0,0,.35); }

    /* ---------------- Glow ONLY on pick text ---------------- */
    .neon-elim{
      color:#ff3b3b;
      text-shadow:0 0 6px rgba(255,0,0,.9),0 0 14px rgba(255,0,0,.6),0 0 24px rgba(255,0,0,.4);
      animation: neonPulse 1.2s ease-in-out infinite;
    }
    @keyframes neonPulse{
      0%{ text-shadow:0 0 4px rgba(255,0,0,.5),0 0 8px rgba(255,0,0,.4),0 0 16px rgba(255,0,0,.2);}
      50%{ text-shadow:0 0 10px rgba(255,0,0,1),0 0 22px rgba(255,0,0,.8),0 0 36px rgba(255,0,0,.6);}
      100%{ text-shadow:0 0 4px rgba(255,0,0,.5),0 0 8px rgba(255,0,0,.4),0 0 16px rgba(255,0,0,.2);}
    }
    .neon-alive{
      color:#5bff8a;
      text-shadow:0 0 6px rgba(0,255,120,.9),0 0 14px rgba(0,255,120,.6),0 0 24px rgba(0,255,120,.4);
      animation: neonPulseG 1.2s ease-in-out infinite;
    }
    @keyframes neonPulseG{
      0%{ text-shadow:0 0 4px rgba(0,255,120,.5),0 0 8px rgba(0,255,120,.4),0 0 16px rgba(0,255,120,.2);}
      50%{ text-shadow:0 0 10px rgba(0,255,120,1),0 0 22px rgba(0,255,120,.8),0 0 36px rgba(0,255,120,.6);}
      100%{ text-shadow:0 0 4px rgba(0,255,120,.5),0 0 8px rgba(0,255,120,.4),0 0 16px rgba(0,255,120,.2);}
    }
    @media (prefers-reduced-motion: reduce){
      .neon-elim, .neon-alive { animation: none; }
    }

    /* ---------------- Panels (yellow outline/dividers) ---------------- */
    .panel-yellow{ background: rgba(0,0,0,.72); border:1px solid rgba(255,204,0,.6); border-radius:16px; }
    .y-divider > * + *{ border-left:1px solid rgba(255,204,0,.55); }

    /* Winner/Spoon fun */
    .trophy-pulse{ animation:tpulse 1.4s ease-in-out infinite; filter: drop-shadow(0 0 6px rgba(255,204,0,.9)) drop-shadow(0 0 16px rgba(255,204,0,.6)); }
    @keyframes tpulse{ 0%{ transform:scale(1);} 50%{ transform:scale(1.06);} 100%{ transform:scale(1);} }
    .spoon-wobble{ animation:wob 1.8s ease-in-out infinite; filter: drop-shadow(0 0 4px rgba(255,99,132,.8)) drop-shadow(0 0 12px rgba(255,99,132,.5)); }
    @keyframes wob{ 0%,100%{ transform:rotate(0deg);} 25%{ transform:rotate(2deg);} 75%{ transform:rotate(-2deg);} }
    @media (prefers-reduced-motion: reduce){ .trophy-pulse,.spoon-wobble{ animation:none; } }

    /* ---------------- Clean table styling (no table glow) ---------------- */
    .picks-clean{
      background: rgba(0,0,0,.72);
      border: 1px solid rgba(255,204,0,.6);
      border-radius: 16px;
    }
    .table-grid{
      width:100%;
      background: transparent;
      border-collapse: separate;
      border-spacing: 0;
    }
    .table-grid thead tr{ background: rgba(255,204,0,.08); }
    .table-grid th, .table-grid td{
      font-family:'Freshman', ui-sans-serif, system-ui;
      letter-spacing:.02em;
      padding:12px 16px;
      border-right:1px solid rgba(255,204,0,.55);
      border-bottom:1px solid rgba(255,204,0,.55);
    }
    .table-grid th{ color:#facc15; font-weight:800; }
    .table-grid tr:last-child td{ border-bottom:0; }
    .table-grid th:last-child, .table-grid td:last-child{ border-right:0; }
  </style>
</head>

<body class="min-h-screen text-white relative">
  <header class="max-w-6xl mx-auto px-4 sm:px-6 py-6 flex items-center justify-between">
    <div>
      <h1 class="text-3xl sm:text-4xl font-black tracking-tight" style="font-family: Freshman, ui-sans-serif, system-ui">
        Super Bowl LIX ‚Äî League Table
      </h1>
      <p class="text-white/70 text-sm sm:text-base">Single-page app ‚Ä¢ Tailwind ‚Ä¢ Freshman.ttf ‚Ä¢ Responsive</p>
    </div>
    <div class="flex items-center gap-2">
      <a id="repoLink" href="#" target="_blank" rel="noopener"
         class="hidden sm:inline-flex text-xs sm:text-sm px-3 py-1.5 rounded-lg bg-white/10 hover:bg-white/20">
        View Repo
      </a>
      <button id="openRules" class="text-xs sm:text-sm px-3 py-1.5 rounded-lg bg-white/10 hover:bg-white/20">Rules</button>
    </div>
  </header>

  <main class="max-w-6xl mx-auto px-4 sm:px-6 pb-24">
    <!-- Season Highlight & Hall of Fame -->
    <section class="grid md:grid-cols-2 gap-4 md:gap-6 mb-6">
      <!-- Season Highlight -->
      <div class="panel-yellow card-hover p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-4" style="font-family: Freshman">Season Highlight</h2>
        <div class="grid grid-cols-2 y-divider">
          <div class="pr-3">
            <p class="text-amber-400 font-semibold mb-2">Winner</p>
            <div class="flex items-center gap-3">
              <img id="seasonWinnerAvatar" src="Assets/winnertbc.png" alt="Winner avatar"
                   class="trophy-pulse w-14 h-14 rounded-full ring-2 ring-amber-400 object-cover" />
              <div>
                <div id="seasonWinnerName" class="text-lg font-bold">TBC</div>
                <div id="seasonWinnerTeam" class="text-xs text-white/60">‚Äî</div>
              </div>
            </div>
          </div>
          <div class="pl-3">
            <p class="text-rose-400 font-semibold mb-2">Spoon</p>
            <div class="flex items-center gap-3">
              <img id="seasonSpoonAvatar" src="Assets/losertbc.png" alt="Spoon avatar"
                   class="spoon-wobble w-14 h-14 rounded-full ring-2 ring-rose-400 object-cover" />
              <div>
                <div id="seasonSpoonName" class="text-lg font-bold">TBC</div>
                <div id="seasonSpoonTeam" class="text-xs text-white/60">‚Äî</div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Hall of Fame -->
      <div class="panel-yellow card-hover p-4 sm:p-6">
        <h2 class="text-xl sm:text-2xl font-bold mb-4" style="font-family: Freshman">Hall of Fame</h2>
        <div id="hallOfFame" class="grid grid-cols-2 sm:grid-cols-3 gap-3"></div>
      </div>
    </section>

    <!-- Player Picks -->
    <section id="picksSection" class="card-hover rounded-2xl p-4 sm:p-6 mb-6 picks-clean">
      <h2 class="text-xl sm:text-2xl font-bold mb-4" style="font-family: Freshman">Player Picks</h2>
      <div class="overflow-x-auto">
        <table class="min-w-full border-separate border-spacing-0 table-grid">
          <thead>
            <tr>
              <th class="text-left">Player</th>
              <th class="text-center">
                <div class="flex items-center gap-2 justify-center">
                  <img src="Assets/afc.png" class="w-5 h-5" alt="AFC" />
                  AFC Team
                </div>
              </th>
              <th class="text-center">
                <div class="flex items-center gap-2 justify-center">
                  <img src="Assets/nfc.png" class="w-5 h-5" alt="NFC" />
                  NFC Team
                </div>
              </th>
            </tr>
          </thead>
          <tbody id="playerPicksBody"></tbody>
        </table>
      </div>
    </section>
  </main>

  <!-- Rules Modal -->
  <div id="rulesModal" class="modal-hidden fixed inset-0 z-50">
    <div class="absolute inset-0 bg-black/70"></div>
    <div class="relative mx-auto mt-10 sm:mt-16 max-w-2xl bg-black rounded-2xl shadow-xl shadow-black/50 p-5 sm:p-6">
      <button id="closeRules" class="absolute right-3 top-3 text-white/70 hover:text-white" aria-label="Close">‚úï</button>
      <h3 class="text-2xl font-bold mb-3" style="font-family: Freshman">Rules</h3>
      <div class="space-y-2 text-white/90 text-sm leading-relaxed">
        <p>‚Ä¢ Submit picks before <span class="rule-key">6PM UK</span> on game day.</p>
        <p>‚Ä¢ This board is **elimination only** ‚Äî last pick standing wins.</p>
        <p>‚Ä¢ No tiebreakers.</p>
      </div>
    </div>
  </div>

  <script>
    // -------- Fallback data (works before you wire JSON files) --------
    const fallbackPlayers = [
      { id: 'matt', name: 'Matt', avatar: 'Assets/matt.png',  team: '49ers',  teamLogo: 'Assets/49ers.png' },
      { id: 'gaz',  name: 'Gaz',  avatar: 'Assets/gaz.png',   team: 'Bills',  teamLogo: 'Assets/Bills.png' },
      { id: 'colesy', name: 'Colesy', avatar: 'Assets/coley.png', team: 'Vikings', teamLogo: 'Assets/Vikings.png' },
      { id: 'jarv', name: 'Jarv', avatar: 'Assets/jarv.png',  team: 'Rams',   teamLogo: 'Assets/Rams.png' },
      { id: 'joe',  name: 'Joe',  avatar: 'Assets/joe.png',   team: 'Lions',  teamLogo: 'Assets/Lions.png' },
      { id: 'ben',  name: 'Ben',  avatar: 'Assets/ben.png',   team: 'Eagles', teamLogo: 'Assets/Eagles.png' },
      { id: 'mark', name: 'Mark', avatar: 'Assets/mark.png',  team: 'Texans', teamLogo: 'Assets/Texans.png' }
    ];
    const fallbackConfig = {
      season: '2025',
      repoUrl: 'https://github.com/your/repo',
      highlight: { winner: null, spoon: null },
      honorary: [ { year: 2024, player: 'matt' } ]
    };
    const fallbackPicks = {
      matt:{afcTeam:'Kansas City Chiefs', nfcTeam:'Detroit Lions'},
      gaz:{afcTeam:'Buffalo Bills', nfcTeam:'Green Bay Packers'},
      colesy:{afcTeam:'Denver Broncos', nfcTeam:'Minnesota Vikings'},
      jarv:{afcTeam:'Baltimore Ravens', nfcTeam:'Los Angeles Rams'},
      joe:{afcTeam:'Los Angeles Chargers', nfcTeam:'Tampa Bay Buccaneers'},
      ben:{afcTeam:'Pittsburgh Steelers', nfcTeam:'Philadelphia Eagles'},
      mark:{afcTeam:'Houston Texans', nfcTeam:'Washington Commanders'}
    };
    const fallbackEliminated = [
      'Minnesota Vikings','Los Angeles Chargers','Pittsburgh Steelers','Denver Broncos',
      'Green Bay Packers','Tampa Bay Buccaneers','Detroit Lions','Los Angeles Rams',
      'Baltimore Ravens','Houston Texans'
    ];

    // -------- Utilities --------
    async function fetchJson(path, fallback){
      try { const res = await fetch(path, {cache:'no-store'}); if(!res.ok) throw 0; return await res.json(); }
      catch { return structuredClone(fallback); }
    }
    function indexBy(arr, key='id'){ const m=new Map(); arr.forEach(o=>m.set(o[key],o)); return m; }
    function slugifyTeam(name){
      return String(name).toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
    }

    // -------- Rendering: Player Picks --------
    function renderPicks(players, picks, eliminated){
      const tbody = document.getElementById('playerPicksBody');
      if(!tbody) return;
      const elim = new Set(eliminated||[]);
      tbody.innerHTML='';

      players.forEach(p=>{
        const pk = picks[p.id] || {};
        const afcElim = elim.has(pk.afcTeam);
        const nfcElim = elim.has(pk.nfcTeam);

        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>
            <div class="flex items-center gap-3">
              <img src="${p.avatar}" alt="${p.name}" class="w-10 h-10 rounded-full object-cover" />
              <div class="font-semibold">${p.name}</div>
            </div>
          </td>
          <td>
            <div class="flex items-center justify-center gap-2">
              ${pk.afcTeam ? `<img src="Assets/teams/${slugifyTeam(pk.afcTeam)}.png"
                    alt="${pk.afcTeam} logo" class="w-5 h-5 object-contain" onerror="this.style.display='none'">` : ''}
              <span class="${afcElim ? 'line-through neon-elim font-semibold' : 'neon-alive font-semibold'}">
                ${pk.afcTeam || '‚Äî'}
              </span>
            </div>
          </td>
          <td>
            <div class="flex items-center justify-center gap-2">
              ${pk.nfcTeam ? `<img src="Assets/teams/${slugifyTeam(pk.nfcTeam)}.png"
                    alt="${pk.nfcTeam} logo" class="w-5 h-5 object-contain" onerror="this.style.display='none'">` : ''}
              <span class="${nfcElim ? 'line-through neon-elim font-semibold' : 'neon-alive font-semibold'}">
                ${pk.nfcTeam || '‚Äî'}
              </span>
            </div>
          </td>`;
        tbody.appendChild(tr);
      });
    }

    // -------- Highlight & Hall of Fame --------
    function applyHighlights(players, config){
      const pIndex = indexBy(players);
      function setHighlight(role, id){
        if(!id) return;
        const elA=document.getElementById(role==='winner'?'seasonWinnerAvatar':'seasonSpoonAvatar');
        const elN=document.getElementById(role==='winner'?'seasonWinnerName':'seasonSpoonName');
        const elT=document.getElementById(role==='winner'?'seasonWinnerTeam':'seasonSpoonTeam');
        const p=pIndex.get(id);
        if(p){ if(elA) elA.src=p.avatar; if(elN) elN.textContent=p.name; if(elT) elT.textContent=p.team||''; }
      }
      setHighlight('winner', config?.highlight?.winner);
      setHighlight('spoon',  config?.highlight?.spoon);

      const hof=document.getElementById('hallOfFame');
      if(hof){
        hof.innerHTML='';
        (config.honorary||[]).forEach(entry=>{
          const p=pIndex.get(entry.player)||{ name: entry.player, avatar:'Assets/winnertbc.png' };
          const card=document.createElement('div');
          card.className='flex flex-col items-center gap-2 p-3 rounded-xl bg-white/5 ring-1 ring-white/10';
          card.innerHTML = `
            <img src="${p.avatar}" alt="${p.name}" class="w-12 h-12 rounded-full object-cover"/>
            <div class="text-xs text-white/70" style="font-family: Freshman">Super Bowl ${config.season} Champion</div>`;
          hof.appendChild(card);
        });
      }
    }

    // -------- Rules modal --------
    function openRules(){ const m=document.getElementById('rulesModal'); if(!m) return; m.classList.remove('modal-hidden'); m.classList.add('modal-shown'); document.body.classList.add('no-scroll'); }
    function closeRules(){ const m=document.getElementById('rulesModal'); if(!m) return; m.classList.add('modal-hidden'); m.classList.remove('modal-shown'); document.body.classList.remove('no-scroll'); }

    // -------- Init --------
    async function init(){
      try{
        const [players, config, picks, eliminated] = await Promise.all([
          fetchJson('players.json', fallbackPlayers),
          fetchJson('config.json', fallbackConfig),
          fetchJson('picks.json', fallbackPicks),
          fetchJson('eliminatedTeams.json', fallbackEliminated)
        ]);

        const repoLink=document.getElementById('repoLink');
        if (repoLink && config.repoUrl) { repoLink.href = config.repoUrl; repoLink.classList.remove('hidden'); }

        applyHighlights(players, config);
        renderPicks(players, picks, eliminated);

        const open=document.getElementById('openRules'); if(open) open.addEventListener('click', openRules);
        const close=document.getElementById('closeRules'); if(close) close.addEventListener('click', closeRules);
        const modal=document.getElementById('rulesModal'); if(modal) modal.addEventListener('click', e=>{ if(e.target===e.currentTarget) closeRules(); });
        document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeRules(); });
      } catch(err){ console.error('Init error', err); }
    }
    document.addEventListener('DOMContentLoaded', init);
  </script>
</body>
</html>
